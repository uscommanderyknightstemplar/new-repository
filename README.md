# new-repository
 dist/aurelia-framework.js  @@ -68,14 +68,12 @@ export class Aurelia {      * @return Returns a Promise with the started Aurelia instance.      */     start(): Promise&lt;Aurelia> {  -    if (this.started) {  -      return Promise.resolve(this);  +    if (this._started) {  +      return this._started;       }     -    this.started = true;       this.logger.info('Aurelia Starting');  -  -    return this.use.apply().then(() => {  +    return this._started = this.use.apply().then(() => {         preventActionlessFormSubmit();            if (!this.container.hasResolver(BindingLanguage)) {  @@ -378,12 +376,11 @@ export class FrameworkConfiguration {      * @param config The configuration for the specified plugin.      * @return Returns the current FrameworkConfiguration instance.      */  -  feature(plugin: string, config?: any): FrameworkConfiguration {  -    if (getExt(plugin)) {  -      return this.plugin({ moduleId: plugin, resourcesRelativeTo: [plugin, ''], config: config || {} });  -    }  -  -    return this.plugin({ moduleId: plugin + '/index', resourcesRelativeTo: [plugin, ''], config: config || {} });  +  feature(plugin: string, config?: any = {}): FrameworkConfiguration {  +    let hasIndex = /\/index$/i.test(plugin);  +    let moduleId = hasIndex || getExt(plugin) ? plugin : plugin + '/index';  +    let root = hasIndex ? plugin.substr(0, plugin.length - 6) : plugin;  +    return this.plugin({ moduleId, resourcesRelativeTo: [root, ''], config });     }        /**  @@ -461,6 +458,14 @@ export class FrameworkConfiguration {       return this;     }     +  // Default configuration helpers  +  // Note: Please do NOT add PLATFORM.moduleName() around those module names.  +  //       Those functions are not guaranteed to be called, they are here to faciliate  +  //       common configurations. If they are not called, we don't want to include a  +  //       static dependency on those modules.  +  //       Including those modules in the bundle or not is a decision that must be  +  //       taken by the bundling tool, at build time.  +     /**      * Plugs in the default binding language from aurelia-templating-binding.      * @return Returns the current FrameworkConfiguration instance. View 19  dist/commonjs/aurelia-framework.js  @@ -140,14 +140,12 @@ var Aurelia = exports.Aurelia = function () {     Aurelia.prototype.start = function start() {       var _this = this;     -    if (this.started) {  -      return Promise.resolve(this);  +    if (this._started) {  +      return this._started;       }     -    this.started = true;       this.logger.info('Aurelia Starting');  -  -    return this.use.apply().then(function () {  +    return this._started = this.use.apply().then(function () {         preventActionlessFormSubmit();            if (!_this.container.hasResolver(_aureliaTemplating.BindingLanguage)) {  @@ -412,12 +410,13 @@ var FrameworkConfiguration = function () {       return this;     };     -  FrameworkConfiguration.prototype.feature = function feature(plugin, config) {  -    if (getExt(plugin)) {  -      return this.plugin({ moduleId: plugin, resourcesRelativeTo: [plugin, ''], config: config || {} });  -    }  +  FrameworkConfiguration.prototype.feature = function feature(plugin) {  +    var config = arguments.length &lt;= 1 || arguments[1] === undefined ? {} : arguments[1];     -    return this.plugin({ moduleId: plugin + '/index', resourcesRelativeTo: [plugin, ''], config: config || {} });  +    var hasIndex = /\/index$/i.test(plugin);  +    var moduleId = hasIndex || getExt(plugin) ? plugin : plugin + '/index';  +    var root = hasIndex ? plugin.substr(0, plugin.length - 6) : plugin;  +    return this.plugin({ moduleId: moduleId, resourcesRelativeTo: [root, ''], config: config });     };        FrameworkConfiguration.prototype.globalResources = function globalResources(resources) { View 19  dist/es2015/aurelia-framework.js  @@ -32,14 +32,12 @@ export let Aurelia = class Aurelia {     }        start() {  -    if (this.started) {  -      return Promise.resolve(this);  +    if (this._started) {  +      return this._started;       }     -    this.started = true;       this.logger.info('Aurelia Starting');  -  -    return this.use.apply().then(() => {  +    return this._started = this.use.apply().then(() => {         preventActionlessFormSubmit();            if (!this.container.hasResolver(BindingLanguage)) {  @@ -276,12 +274,11 @@ export let FrameworkConfiguration = class FrameworkConfiguration {       return this;     }     -  feature(plugin, config) {  -    if (getExt(plugin)) {  -      return this.plugin({ moduleId: plugin, resourcesRelativeTo: [plugin, ''], config: config || {} });  -    }  -  -    return this.plugin({ moduleId: plugin + '/index', resourcesRelativeTo: [plugin, ''], config: config || {} });  +  feature(plugin, config = {}) {  +    let hasIndex = /\/index$/i.test(plugin);  +    let moduleId = hasIndex || getExt(plugin) ? plugin : plugin + '/index';  +    let root = hasIndex ? plugin.substr(0, plugin.length - 6) : plugin;  +    return this.plugin({ moduleId, resourcesRelativeTo: [root, ''], config });     }        globalResources(resources) { View 19  dist/native-modules/aurelia-framework.js  @@ -38,14 +38,12 @@ export var Aurelia = function () {     Aurelia.prototype.start = function start() {       var _this = this;     -    if (this.started) {  -      return Promise.resolve(this);  +    if (this._started) {  +      return this._started;       }     -    this.started = true;       this.logger.info('Aurelia Starting');  -  -    return this.use.apply().then(function () {  +    return this._started = this.use.apply().then(function () {         preventActionlessFormSubmit();            if (!_this.container.hasResolver(BindingLanguage)) {  @@ -310,12 +308,13 @@ var FrameworkConfiguration = function () {       return this;     };     -  FrameworkConfiguration.prototype.feature = function feature(plugin, config) {  -    if (getExt(plugin)) {  -      return this.plugin({ moduleId: plugin, resourcesRelativeTo: [plugin, ''], config: config || {} });  -    }  +  FrameworkConfiguration.prototype.feature = function feature(plugin) {  +    var config = arguments.length &lt;= 1 || arguments[1] === undefined ? {} : arguments[1];     -    return this.plugin({ moduleId: plugin + '/index', resourcesRelativeTo: [plugin, ''], config: config || {} });  +    var hasIndex = /\/index$/i.test(plugin);  +    var moduleId = hasIndex || getExt(plugin) ? plugin : plugin + '/index';  +    var root = hasIndex ? plugin.substr(0, plugin.length - 6) : plugin;  +    return this.plugin({ moduleId: moduleId, resourcesRelativeTo: [root, ''], config: config });     };        FrameworkConfiguration.prototype.globalResources = function globalResources(resources) { View 19  dist/system/aurelia-framework.js  @@ -225,14 +225,12 @@ System.register(['aurelia-logging', 'aurelia-dependency-injection', 'aurelia-loa           Aurelia.prototype.start = function start() {             var _this = this;     -          if (this.started) {  -            return Promise.resolve(this);  +          if (this._started) {  +            return this._started;             }     -          this.started = true;             this.logger.info('Aurelia Starting');  -  -          return this.use.apply().then(function () {  +          return this._started = this.use.apply().then(function () {               preventActionlessFormSubmit();                  if (!_this.container.hasResolver(BindingLanguage)) {  @@ -393,12 +391,13 @@ System.register(['aurelia-logging', 'aurelia-dependency-injection', 'aurelia-loa             return this;           };     -        FrameworkConfiguration.prototype.feature = function feature(plugin, config) {  -          if (getExt(plugin)) {  -            return this.plugin({ moduleId: plugin, resourcesRelativeTo: [plugin, ''], config: config || {} });  -          }  +        FrameworkConfiguration.prototype.feature = function feature(plugin) {  +          var config = arguments.length &lt;= 1 || arguments[1] === undefined ? {} : arguments[1];     -          return this.plugin({ moduleId: plugin + '/index', resourcesRelativeTo: [plugin, ''], config: config || {} });  +          var hasIndex = /\/index$/i.test(plugin);  +          var moduleId = hasIndex || getExt(plugin) ? plugin : plugin + '/index';  +          var root = hasIndex ? plugin.substr(0, plugin.length - 6) : plugin;  +          return this.plugin({ moduleId: moduleId, resourcesRelativeTo: [root, ''], config: config });           };              FrameworkConfiguration.prototype.globalResources = function globalResources(resources) {
